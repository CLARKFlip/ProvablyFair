<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CLARKflip | Provably Fair</title>
    <link rel="icon" href="logo_coin.ico" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700;900&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="index.css" />
  </head>
  <body>
    <div
      id="splash-init"
      style="
        position: fixed;
        inset: 0;
        z-index: 99999;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--bg);
      "
    >
      <div id="splash-logo-wrap" style="display: flex; align-items: center; justify-content: center">
        <svg
          id="splash-logo"
          width="160"
          height="160"
          viewBox="0 0 1121 1121"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <defs>
            <mask id="splash-mask">
              <rect
                id="splash-mask-rect"
                rx="9999"
                ry="9999"
                x="0"
                y="0"
                width="0"
                height="0"
                fill="white"
                transform="rotate(45 0 0)"
              />
            </mask>
          </defs>
          <g mask="url(#splash-mask)">
            <path
              fill="#32FF7C"
              opacity="1.000000"
              stroke="none"
              d="
M0.999990,875.468628 
	C1.663164,874.358154 2.828875,873.778625 2.917349,873.065552 
	C7.031232,839.904602 16.617752,808.166443 29.397255,777.511780 
	C40.031895,752.002014 51.576164,726.791077 64.231659,702.227905 
	C75.834503,679.707886 88.936211,657.903320 102.344566,636.386169 
	C115.947136,614.557373 130.356689,593.202271 145.119064,572.134521 
	C157.225052,554.857849 170.176987,538.159668 183.104416,521.476685 
	C196.033539,504.791443 209.243759,488.316986 222.631760,471.997040 
	C230.045319,462.959961 238.012344,454.371796 245.840851,445.681244 
	C261.646667,428.134766 277.194550,410.338959 293.471558,393.238708 
	C310.010498,375.863281 327.265900,359.167725 344.351074,342.320007 
	C345.268463,341.415375 348.000427,341.103699 349.066467,341.790588 
	C359.433716,348.470215 369.625671,355.421844 380.081696,362.439636 
	C361.636444,380.878479 343.180206,398.946899 325.172302,417.451538 
	C310.960175,432.055603 297.133392,447.045715 283.444824,462.144806 
	C271.723022,475.074524 260.243500,488.236908 249.017502,501.599457 
	C237.423004,515.400696 225.957458,529.332397 214.982880,543.627258 
	C196.581024,567.596558 178.033691,591.490601 160.633759,616.181763 
	C144.792618,638.661072 129.868256,661.835999 115.534843,685.311890 
	C104.769569,702.943604 95.414825,721.449890 85.729691,739.724548 
	C70.709732,768.065125 58.179688,797.468567 48.932400,828.223389 
	C43.578190,846.030457 39.667198,864.055908 37.785973,882.651794 
	C36.050896,899.803040 37.046928,916.556702 42.491978,932.694946 
	C49.988510,954.913513 65.841209,969.167542 88.227364,975.929565 
	C104.385429,980.810181 120.888046,980.744507 137.574127,979.107422 
	C161.728668,976.737732 184.952774,970.628784 207.485031,962.029541 
	C225.063599,955.320923 242.371262,947.837524 259.520752,940.082397 
	C299.817780,921.859802 337.539093,898.999084 374.041565,874.220886 
	C401.458221,855.610229 428.275940,836.088684 454.909790,816.364319 
	C469.777924,805.353333 483.911041,793.318604 498.043243,781.352966 
	C516.027161,766.125977 533.758362,750.596497 551.437317,735.014587 
	C562.718140,725.072021 573.938721,715.039185 584.775208,704.619263 
	C603.355408,686.753357 621.710144,668.649414 639.966431,650.451721 
	C649.002441,641.444641 657.608276,632.006104 666.801270,622.350464 
	C671.986206,628.244080 676.970154,633.650879 681.660339,639.301392 
	C688.569153,647.624695 695.311279,656.087891 702.047241,664.552917 
	C712.247437,677.371338 722.858887,689.897827 732.436584,703.168335 
	C748.752686,725.775024 764.314453,748.924927 780.438293,771.672791 
	C782.495239,774.574829 781.704834,775.854065 779.714233,777.834473 
	C764.120117,793.348511 748.776428,809.119629 732.973999,824.417297 
	C718.460571,838.467102 703.739624,852.328247 688.622986,865.722656 
	C670.791077,881.522888 652.458679,896.759216 634.302185,912.191772 
	C604.002869,937.945435 572.443542,962.087585 539.714844,984.641785 
	C517.336304,1000.063477 494.612274,1015.018738 471.583801,1029.450195 
	C456.269226,1039.047363 440.358246,1047.760498 424.329071,1056.131958 
	C405.129883,1066.159058 385.761749,1075.934326 366.030945,1084.854736 
	C338.059937,1097.500488 309.088959,1107.581787 279.223938,1114.791626 
	C269.106628,1117.234131 258.661041,1118.311279 248.377167,1120.080444 
	C247.646545,1120.206055 247.012741,1120.894287 246.666962,1121.660400 
	C228.645767,1122.000000 210.291550,1122.000000 191.807007,1121.677368 
	C187.505478,1120.237671 183.333603,1119.123047 179.163132,1118.003174 
	C162.692032,1113.580078 147.803436,1106.524902 135.533066,1094.146973 
	C99.326050,1057.622437 62.855446,1021.359192 26.490561,984.991150 
	C25.432566,983.933044 24.273170,982.944031 23.380915,981.757446 
	C12.645820,967.480347 5.660493,951.600037 2.919212,933.888550 
	C2.809090,933.177063 1.663265,932.625916 0.999995,932.000000 
	C1.000000,913.312439 1.000000,894.624878 0.999990,875.468628 
z"
            />
            <path
              fill="#3073FF"
              opacity="1.000000"
              stroke="none"
              d="
M256.531342,0.999999 
	C257.639435,1.663010 258.225250,2.841447 258.926117,2.914387 
	C282.336395,5.350779 305.009888,11.188530 327.413696,18.056009 
	C353.991852,26.203056 379.865967,36.244785 405.084137,47.987453 
	C443.398834,65.828423 480.712250,85.493866 516.131104,108.616028 
	C536.715881,122.054184 557.166199,135.698257 577.657104,149.279831 
	C578.612488,149.913071 579.372314,150.841400 580.417175,151.812637 
	C613.772766,130.266724 648.017822,110.171288 683.747192,92.725967 
	C713.568542,78.165283 743.987732,64.886848 775.936035,55.740952 
	C793.860779,50.609581 812.130188,46.264709 830.525879,43.331310 
	C844.470215,41.107742 858.912476,40.570827 873.039307,41.246418 
	C897.343079,42.408714 920.312256,48.714855 939.804871,64.370102 
	C940.967163,65.303520 941.956543,66.453667 943.016113,67.513260 
	C978.723267,103.219872 1014.421387,138.935562 1050.139038,174.631699 
	C1064.967285,189.450974 1073.532959,207.537216 1076.854614,227.963501 
	C1078.694336,239.276337 1080.324463,250.912292 1079.689209,262.270630 
	C1078.742065,279.204254 1076.518799,296.173096 1073.387695,312.854645 
	C1067.766357,342.803009 1057.869507,371.617340 1045.499268,399.354858 
	C1033.698730,425.815033 1020.809082,451.863464 1006.983765,477.324921 
	C994.341309,500.607971 979.790466,522.853821 966.130249,545.586548 
	C964.720886,547.931946 964.285706,549.897095 966.158752,552.919434 
	C979.540039,574.511658 992.904541,596.134766 1005.462891,618.209717 
	C1015.052551,635.066406 1024.140381,652.285278 1032.205322,669.913147 
	C1042.128662,691.602905 1051.171143,713.723755 1059.831299,735.955444 
	C1068.744873,758.837830 1074.884644,782.622375 1079.711304,806.676880 
	C1081.860962,817.390137 1083.095947,828.349243 1083.874146,839.258972 
	C1084.758057,851.650452 1085.449341,864.149658 1084.844116,876.534607 
	C1083.391602,906.256165 1076.115112,934.256409 1056.615601,957.730469 
	C1051.373901,964.040588 1045.069214,969.472290 1039.173950,975.226868 
	C1038.596558,975.790466 1037.465820,975.787231 1035.591797,976.344482 
	C1046.147827,962.598938 1051.274414,947.512329 1053.737915,931.763550 
	C1055.839966,918.324524 1056.510376,904.735474 1055.288086,890.907410 
	C1053.553467,871.284973 1050.666138,851.960083 1044.940674,833.195984 
	C1038.693726,812.722778 1032.290283,792.222412 1024.426147,772.338623 
	C1016.482422,752.253845 1007.690613,732.355957 997.432190,713.369385 
	C981.335571,683.577332 964.747803,653.941711 946.429260,625.488037 
	C925.888733,593.583130 903.630249,562.746948 881.266541,532.067261 
	C868.050354,513.936707 853.338501,496.881042 839.010010,479.581543 
	C827.271423,465.408844 815.231506,451.479370 803.088562,437.649811 
	C793.280090,426.478973 783.348450,415.397949 773.066772,404.664734 
	C750.984924,381.613312 728.905396,358.548035 706.313599,336.000824 
	C691.188782,320.905823 675.337646,306.523621 659.526306,292.136017 
	C646.475647,280.260620 633.296570,268.491516 619.657166,257.305939 
	C597.083679,238.793594 574.536011,220.197525 551.164673,202.723862 
	C523.735962,182.216644 495.775604,162.372543 467.400421,143.195786 
	C448.403839,130.357346 428.541565,118.727409 408.590332,107.395317 
	C390.188049,96.943008 371.376831,87.144028 352.343933,77.883026 
	C316.747040,60.562298 279.888641,46.358944 241.287918,37.334240 
	C227.348236,34.075191 212.917755,32.788891 198.652252,31.100815 
	C190.957397,30.190264 183.103439,29.699778 175.381287,30.120806 
	C153.663773,31.304895 132.708725,35.514088 114.313843,48.161118 
	C113.797821,48.515907 113.185585,48.761139 112.584183,48.947895 
	C112.305695,49.034374 111.945282,48.857021 111.244331,48.731819 
	C124.397408,31.362885 140.765503,18.408625 161.109024,11.218625 
	C171.601410,7.510305 182.751953,5.668108 193.591858,2.930273 
	C194.333450,2.742967 194.963837,2.115417 195.322968,1.346303 
	C215.354233,1.000000 235.708450,1.000000 256.531342,0.999999 
M913.929626,264.377777 
	C923.981079,237.879990 932.605530,211.067841 936.217102,182.728607 
	C938.281067,166.533157 938.311279,150.670502 934.993225,134.750763 
	C932.090576,120.823837 925.906982,108.378387 915.775146,98.552330 
	C902.518799,85.695900 885.661377,79.671715 867.614502,78.187141 
	C847.671509,76.546593 827.799500,78.680550 808.315552,83.359077 
	C775.455322,91.249550 744.119324,103.473671 713.793884,118.170662 
	C696.051636,126.769287 678.719727,136.268250 661.541504,145.961548 
	C645.138489,155.217377 629.173767,165.250031 612.515442,175.241684 
	C697.871521,240.553818 775.020447,313.672821 845.788086,394.298004 
	C846.587524,393.236237 847.174622,392.612732 847.585083,391.889130 
	C861.487000,367.380615 875.938965,343.161133 889.064819,318.243195 
	C898.146790,301.002106 905.395447,282.795258 913.929626,264.377777 
z"
            />
            <path
              fill="#32FF7C"
              opacity="1.000000"
              stroke="none"
              d="
M90.261215,310.575470 
	C95.838646,334.101685 103.551926,356.473175 113.078072,378.209900 
	C118.569061,390.739197 124.475014,403.086578 130.184952,415.520111 
	C130.484009,416.171295 130.696472,416.862274 130.168304,417.923065 
	C127.071945,412.455963 123.941040,407.008118 120.884865,401.518677 
	C101.537109,366.766479 84.292480,331.061707 70.747971,293.585999 
	C62.114521,269.698486 55.091183,245.480438 50.852127,220.395645 
	C48.149364,204.401917 46.304802,188.373657 47.109982,172.220886 
	C48.303375,148.280197 53.490990,125.344818 68.169983,105.652977 
	C78.088081,92.347862 91.298470,83.160027 106.634026,77.001251 
	C118.527962,72.224632 130.933716,70.096634 143.693802,68.843185 
	C164.401108,66.809090 184.615311,69.257050 204.926117,72.842690 
	C238.578659,78.783638 270.589569,89.821976 301.725403,103.458038 
	C321.695312,112.203941 341.679596,121.151443 360.755585,131.647568 
	C387.520294,146.374222 414.070801,161.676208 439.574188,178.462219 
	C471.662506,199.582352 502.845062,222.113647 533.931335,244.706299 
	C549.016113,255.669479 563.155090,267.965179 577.427368,280.007202 
	C594.781006,294.649017 612.055420,309.401855 628.934937,324.583710 
	C645.305176,339.307434 661.196533,354.567383 677.174866,369.721832 
	C688.263062,380.238342 699.349731,390.771179 710.062195,401.665497 
	C723.079712,414.904205 735.849487,428.395142 748.453796,442.029053 
	C759.990784,454.508453 771.450134,467.081787 782.430237,480.048553 
	C798.104492,498.558838 813.781128,517.102295 828.600281,536.292908 
	C848.252747,561.742737 867.278931,587.685120 886.205505,613.684326 
	C905.866821,640.692810 923.778259,668.870483 939.953491,698.101379 
	C951.073792,718.197327 962.196228,738.328918 972.292969,758.946411 
	C990.759827,796.655701 1005.611694,835.805054 1014.752319,876.869751 
	C1017.546570,889.422913 1018.577148,902.400574 1019.904785,915.236694 
	C1020.753967,923.446228 1021.292725,931.783752 1020.881958,940.009521 
	C1019.684998,963.977844 1014.508240,986.919617 999.706665,1006.513123 
	C987.800659,1022.273682 971.773315,1032.553955 952.866821,1037.803345 
	C943.512512,1040.400635 933.726318,1041.562012 924.071045,1042.911255 
	C918.209167,1043.730225 912.217529,1044.035645 906.295471,1043.931763 
	C887.402954,1043.600830 868.794006,1040.806030 850.376282,1036.706543 
	C822.254700,1030.447144 795.301514,1020.568237 768.682373,1009.785278 
	C757.232544,1005.147156 746.154907,999.588806 734.923889,994.414307 
	C733.942017,993.961853 733.077515,993.254761 732.434509,991.984192 
	C738.484314,994.112610 744.544373,996.212280 750.581970,998.374817 
	C769.606323,1005.188843 788.924133,1010.890869 809.109436,1012.956177 
	C818.600952,1013.927307 828.200317,1015.298218 837.662720,1014.803772 
	C858.658813,1013.706604 878.293335,1008.285034 893.308472,992.158569 
	C903.150818,981.587830 908.770630,968.845947 910.883240,954.718628 
	C912.168335,946.124817 913.215515,937.322205 912.813538,928.685852 
	C912.008911,911.398376 908.963684,894.393311 904.359924,877.636658 
	C897.237244,851.711975 887.253906,826.922119 875.950928,802.598389 
	C863.508789,775.823120 849.220764,750.051697 833.501282,725.092529 
	C822.381714,707.437073 811.119812,689.842285 799.164246,672.750000 
	C785.706909,653.510498 771.734619,634.606201 757.366577,616.035645 
	C743.330444,597.894104 728.763306,580.145508 713.957397,562.623169 
	C702.574280,549.151489 690.671326,536.099915 678.620605,523.215942 
	C659.129395,502.376984 639.573120,481.587128 619.570190,461.242676 
	C606.095459,447.537842 591.989136,434.434387 577.827026,421.430389 
	C563.377808,408.162842 548.813110,394.988617 533.759644,382.419586 
	C513.777039,365.734924 493.695465,349.111603 472.882050,333.493927 
	C447.606506,314.528137 421.886169,296.099365 395.668121,278.464264 
	C377.045197,265.937866 357.519867,254.683929 337.949860,243.656204 
	C321.940857,234.635132 305.553467,226.165863 288.830505,218.558334 
	C260.430450,205.638763 231.395599,194.201889 200.391861,189.079590 
	C188.449265,187.106476 176.302872,185.197357 164.261765,185.271713 
	C147.395020,185.375854 130.770355,188.363632 116.241577,197.992798 
	C101.061401,208.053680 92.047409,222.369202 87.993118,239.985825 
	C84.142319,256.718323 83.923019,273.503784 86.943962,290.384338 
	C88.121201,296.962494 89.033844,303.587982 90.261215,310.575470 
z"
            />
            <g>
              <!-- ...logo_coin.svg content here... -->
            </g>
            <!-- END LOGO_COIN CONTENT -->
          </g>
        </svg>
      </div>
    </div>
    <header>
      <img src="logo_full.svg" alt="CLARKflip Logo" />
    </header>
    <div class="main-wrap">
      <nav class="sidebar">
        <div class="sidebar-title">
          <svg width="20" height="20" fill="currentColor" viewBox="0 0 64 64" class="svg-icon">
            <title></title>
            <path
              d="M54.728 15.006h3.118V8.37H34.655V2.61h-6.664v5.758H4.746v6.637h4.505L0 37.452c0 7.037 5.704 12.741 12.741 12.741 7.038 0 12.741-5.704 12.741-12.741l-9.25-22.446h11.73v39.745h-9.303v6.638h25.165V54.75h-9.171V15.006h13.115l-9.25 22.446c0 7.037 5.703 12.741 12.74 12.741C58.297 50.193 64 44.489 64 37.452zM5.334 37.452l7.411-17.887 7.358 17.887zm38.492 0 7.357-17.887 7.463 17.887z"
            ></path>
          </svg>
          Provably Fair
        </div>
        <div class="sidebar-cursor"></div>
        <ul>
          <li><a href="#" class="active" id="nav-calc">Calculation</a></li>
          <li><a href="#" id="nav-how">How It Works</a></li>
        </ul>
      </nav>
      <main id="main-calc" style="">
        <form class="verifier-form" id="squares-form" autocomplete="off">
          <div class="field">
            <label for="mode">Game</label>
            <select class="custom-select" id="mode">
              <option value="squares">Squares</option>
              <option value="coinflip">Coinflip</option>
              <option value="blackjack">Blackjack</option>
            </select>
          </div>
          <div class="field" id="server-seed-field">
            <label for="serverSeed">Server Seed</label>
            <input type="text" id="serverSeed" required placeholder="e.g. 4361c93af5f2b14c" />
          </div>
          <div class="field" id="stain-field">
            <label for="stain">Stain</label>
            <input type="text" id="stain" required placeholder="e.g. 6e2b1a..." />
          </div>
          <div class="field" id="uncovered-field">
            <label for="uncovered">Squares Uncovered</label>
            <span class="number-input-wrap">
              <input type="number" id="uncovered" min="1" max="5" required placeholder="e.g. 2" />
            </span>
          </div>
          <div class="field" id="difficulty-field">
            <label for="difficulty">Difficulty</label>
            <select class="custom-select" id="difficulty" required>
              <option value="easy">Easy (50%)</option>
              <option value="medium">Medium (27.8%)</option>
              <option value="hard">Hard (14.3%)</option>
              <option value="expert">Expert (8.7%)</option>
            </select>
          </div>
        </form>
        <div id="squares-gemstones"></div>
        <section class="source-section">
          <h2>Squares Source Code</h2>
          <pre id="source-code-squares" class="language-javascript"><code>
</code></pre>
        </section>
        <section class="source-section">
          <h2>Coinflip Source Code</h2>
          <pre id="source-code-coinflip" class="language-javascript"><code>
</code></pre>
        </section>
        <section class="source-section">
          <h2>Blackjack Source Code</h2>
          <pre id="source-code-blackjack" class="language-javascript"><code>
</code></pre>
        </section>
      </main>
      <main id="main-how" style="display: none">
        <h2>How Provably Fair Works</h2>
        <p>
          Each game outcome is determined by combining a secret server seed (committed in advance), a public "stain"
          (unique per game), and, for Squares, additional parameters. The server seed is hashed and published before the
          game, so the operator cannot change it after the fact.<br /><br />
          For Coinflip:<br />
          <code>HMAC_SHA256(serverSeed, stain) → hex → integer → decimal → Heads/Tails</code><br />
          <br />
          For Squares:<br />
          <code>HMAC_SHA256(serverSeed, stain + tileIndex) → hex → integer → decimal → Success/Fail</code><br /><br />
          For Blackjack:<br />
          <code>
            Generate initial hash: HMAC_SHA256(serverSeed, stain)<br />
            Use Fisher-Yates algorithm to shuffle a standard 52-card deck:<br />
            &nbsp;&nbsp;For each position i from 51 down to 1:<br />
            &nbsp;&nbsp;&nbsp;&nbsp;Read next 8 bytes from hash as random number<br />
            &nbsp;&nbsp;&nbsp;&nbsp;If more bytes needed, extend with HMAC_SHA256(serverSeed, stain + counter)<br />
            &nbsp;&nbsp;&nbsp;&nbsp;Swap position i with random position 0 to i<br />
            Deal cards alternately: Player gets positions 0,2; Dealer gets 1,3<br />
          </code>
        </p>

        <section style="margin-top: 2.5em">
          <h3>About the Stain Algorithm</h3>
          <p>
            <b>What is a "Stain"?</b><br />
            The <b>stain</b> is a unique, public value generated for each game. It acts as a "salt" or unique
            identifier, ensuring that every game round is cryptographically independent and cannot be predicted or
            manipulated by the server or client.
          </p>
          <p>
            <b>How is the Stain Generated?</b><br />
            The stain is generated from the client seeds of all participants in the game. The backend uses the following
            logic:
          </p>
          <pre
            class="language-javascript"
            style="background: #23273a; color: var(--text-muted); padding: 1em; border-radius: 7px; overflow-x: auto"
          >
<code>generateStain(clientSeeds) {
  const sortedSeeds = clientSeeds.sort();
  const combinedString = sortedSeeds.join("");
  let hashed = crypto.createHash("sha256").update(combinedString).digest("hex");
  return hashed;
}</code>
</pre>
          <ul>
            <li>
              <b>Sorting:</b> The client seeds are sorted alphabetically to ensure the stain is the same regardless of
              the order in which seeds are provided.
            </li>
            <li><b>Combining:</b> The sorted seeds are concatenated into a single string.</li>
            <li>
              <b>Hashing:</b> The combined string is hashed using SHA-256, producing a 64-character hexadecimal stain.
            </li>
          </ul>
          <p>
            This approach guarantees that the stain is deterministic, unique for each set of client seeds, and cannot be
            influenced after the game starts. It also ensures fairness and transparency for all players.
          </p>
          <p>
            <b>Why is this important?</b><br />
            By using the stain as part of the HMAC input for each game, the outcome is tied to both the server's secret
            and the players' public seeds, making the process provably fair and verifiable by anyone.
          </p>
        </section>
      </main>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="index.js"></script>
  </body>
</html>
